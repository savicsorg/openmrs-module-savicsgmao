<?xml version="1.0" encoding="UTF-8"?>
 
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9
                  http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd">
 
    <!--
    	See http://wiki.openmrs.org/display/docs/Module+liquibase+File for 
    	documentation on this file.
    
        See http://www.liquibase.org/manual/home#available_database_refactorings
        for a list of supported elements and attributes
    -->
 
    <!-- Uncomment the changeset below if you want to make the Item class persistable, see also Item and SavicsGmaoModuleDaoTest -->
 	
    <changeSet id="savicsgmao-2016-08-02-12-21" author="raff">
        <preConditions onFail="MARK_RAN">
            <not>
                <tableExists tableName="gmao_item"/>
            </not>
        </preConditions>
        <comment>
            Creating the gmao_item table
        </comment>
        <createTable tableName="gmao_item">
            <column name="item_id" type="int" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="uuid" type="char(38)">
                <constraints nullable="false" unique="true"></constraints>
            </column>
            <column name="owner" type="int" />
            <column name="description" type="varchar(255)" />
        </createTable>
        <addForeignKeyConstraint constraintName="gmao_item_owner_fk" baseTableName="gmao_item" baseColumnNames="owner"  referencedTableName="users"
                                 referencedColumnNames="user_id" />
    </changeSet>
    
    <changeSet author="anatoleabe (generated)" id="1616249208432-1">
        <createTable tableName="gmao_agent">
            <column autoIncrement="true" name="agent_id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="full_name" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="agent_address" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="phone_number" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="roll_number" type="VARCHAR(250)"/>
            <column name="is_external" type="TINYINT(3)">
                <constraints nullable="false"/>
            </column>
            <column name="department_id" type="INT"/>
            <column name="site_location_id" type="INT"/>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1616249208432-2">
        <createTable tableName="gmao_department">
            <column autoIncrement="true" name="department_id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="department_name" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="department_code" type="VARCHAR(250)">
                <constraints nullable="false" unique="true"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1616249208432-3">
        <createTable tableName="gmao_district">
            <column autoIncrement="true" name="district_id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="district_name" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="district_code" type="VARCHAR(250)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="region_id" type="INT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1616249208432-4">
        <createTable tableName="gmao_equipement_type">
            <column autoIncrement="true" name="equipment_type_id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="type_name" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1616249208432-5">
        <createTable tableName="gmao_equipment">
            <column autoIncrement="true" name="equipment_id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="equipment_type_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="serial_number" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="acquisition_date" type="datetime"/>
            <column name="equipment_status" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="designation" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="localization" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="department_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="last_modified_date" type="datetime"/>
            <column name="equipment_weight" type="FLOAT(12)"/>
            <column name="volume" type="FLOAT(12)"/>
            <column name="tracking" type="INT"/>
            <column name="in_service" type="TINYINT(3)"/>
            <column name="operating_state" type="INT"/>
            <column name="commisionning_year" type="INT"/>
            <column name="comments" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="provider_id" type="INT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1616249208432-6">
        <createTable tableName="gmao_equipment_operation">
            <column autoIncrement="true" name="equipment_operation_id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="operation_code" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="operation_type" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="operation_date" type="datetime">
                <constraints nullable="false"/>
            </column>
            <column name="source_site_id" type="INT"/>
            <column name="destination_site_id" type="INT"/>
            <column name="reason" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="local_approval" type="TINYINT(3)"/>
            <column name="local_approval_date" type="datetime"/>
            <column name="central_approval" type="TINYINT(3)"/>
            <column name="central_approval_date" type="datetime"/>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1616249208432-7">
        <createTable tableName="gmao_equipment_operation_item">
            <column autoIncrement="true" name="equipment_operation_item_id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="equipment_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="equipment_operation_id" type="INT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1616249208432-8">
        <createTable tableName="gmao_maintenance">
            <column autoIncrement="true" name="maintenance_id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="maintenance_type_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="designation" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="startdate" type="datetime">
                <constraints nullable="false"/>
            </column>
            <column name="enddate" type="datetime"/>
            <column name="details" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="equipment_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="agent_id" type="INT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1616249208432-9">
        <createTable tableName="gmao_maintenance_reason">
            <column autoIncrement="true" name="maintenance_reason_id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="reason_code" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="reason_name" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="details" type="TEXT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1616249208432-10">
        <createTable tableName="gmao_maintenance_request">
            <column autoIncrement="true" name="maintenance_request_id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="system_number" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="department_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="register_number" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="startdate" type="datetime">
                <constraints nullable="false"/>
            </column>
            <column name="nature_of_work" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="enddate" type="datetime"/>
            <column name="motif" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="request_priority" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="equipment_id" type="INT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1616249208432-11">
        <createTable tableName="gmao_maintenance_task">
            <column autoIncrement="true" name="maintenance_task_id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="designation" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="details" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="executed" type="TINYINT(3)">
                <constraints nullable="false"/>
            </column>
            <column name="task_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="maintenance_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="equipement_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="planification_id" type="INT"/>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1616249208432-12">
        <createTable tableName="gmao_maintenance_type">
            <column autoIncrement="true" name="maintenance_type_id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="type_code" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="type_name" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1616249208432-13">
        <createTable tableName="gmao_planification">
            <column autoIncrement="true" name="planification_id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="designation" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="planification_code" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="planification_date" type="datetime">
                <constraints nullable="false"/>
            </column>
            <column name="observations" type="INT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1616249208432-14">
        <createTable tableName="gmao_region">
            <column autoIncrement="true" name="region_id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="region_name" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="region_code" type="VARCHAR(250)">
                <constraints nullable="false" unique="true"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1616249208432-15">
        <createTable tableName="gmao_site_location">
            <column autoIncrement="true" name="site_location_id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="location_name" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="location_code" type="VARCHAR(250)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="district_id" type="INT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1616249208432-16">
        <createTable tableName="gmao_task">
            <column autoIncrement="true" name="task_id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="task_name" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="task_procedure" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="equipment_type_id" type="INT">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
 
</databaseChangeLog>