<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9
                  http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd">
   
    <changeSet author="anatoleabe (generated)" id="1639051760881-1">
        <createTable tableName="gmao_district">
            <column autoIncrement="true" name="id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="uuid" type="VARCHAR(38)">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="code" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="regionid" type="INT"/>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-2">
        <createTable tableName="gmao_equipment">
            <column autoIncrement="true" name="id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="equipment_type_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="site_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="uuid" type="VARCHAR(38)">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="serial_number" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="type" type="VARCHAR(32)"/>
            <column name="model" type="VARCHAR(32)"/>
            <column name="supplier" type="VARCHAR(32)"/>
            <column name="power" type="VARCHAR(32)"/>
            <column name="explainMore" type="VARCHAR(256)"/>
            <column name="aftersaleservice" type="BIT"/>
            <column name="responsibleperson" type="VARCHAR(32)"/>
            <column name="service_status" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="useraffectedto" type="VARCHAR(32)"/>
            <column name="replacementcomponent" type="INT"/>
            <column name="manuals" type="INT"/>
            <column name="tracking" type="INT"/>
            <column name="commisionning_year" type="INT"/>
            <column name="acquisition_date" type="datetime"/>
            <column name="acquisition_value" type="DOUBLE"/>
            <column name="acquisition_mode" type="VARCHAR(32)"/>
            <column name="volume" type="DOUBLE"/>
            <column name="weight" type="DOUBLE"/>
            <column name="comment" type="TEXT"/>
            <column name="lastmodified" type="datetime"/>
            <column name="creation" type="datetime"/>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-3">
        <createTable tableName="gmao_equipment_type">
            <column autoIncrement="true" name="id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="uuid" type="VARCHAR(38)">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-4">
        <createTable tableName="gmao_healthcenter">
            <column autoIncrement="true" name="id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="distrct_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="uuid" type="VARCHAR(38)">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="code" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="lastmodified" type="datetime"/>
            <column name="creation" type="datetime"/>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-5">
        <createTable tableName="gmao_maintenance">
            <column autoIncrement="true" name="id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="maintenance_requested_id" type="INT"/>
            <column name="maintenance_type_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="equipment_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="uuid" type="VARCHAR(38)">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="startdate" type="datetime">
                <constraints nullable="false"/>
            </column>
            <column name="enddate" type="datetime"/>
            <column name="status" type="SMALLINT">
                <constraints nullable="false"/>
            </column>
            <column name="doneby" type="VARCHAR(255)"/>
            <column name="lastmodified" type="datetime"/>
            <column name="creation" type="datetime"/>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-6">
        <createTable tableName="gmao_maintenance_request">
            <column autoIncrement="true" name="id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="equipment_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="uuid" type="VARCHAR(38)">
                <constraints nullable="false"/>
            </column>
            <column name="requestedby" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="register_number" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="nature_of_work" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="priority" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="motif" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="lastmodified" type="datetime"/>
            <column name="creation" type="datetime"/>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-7">
        <createTable tableName="gmao_maintenance_type">
            <column autoIncrement="true" name="id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="uuid" type="VARCHAR(38)">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-8">
        <createTable tableName="gmao_mouvement">
            <column autoIncrement="true" name="id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="equipment_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="destination_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="source_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="uuid" type="VARCHAR(38)">
                <constraints nullable="false"/>
            </column>
            <column name="type" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="date" type="datetime">
                <constraints nullable="false"/>
            </column>
            <column name="motif" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="localapproval" type="datetime"/>
            <column name="localapprover" type="VARCHAR(32)"/>
            <column name="centralapproval" type="datetime"/>
            <column name="centralapprover" type="VARCHAR(32)"/>
            <column name="creation" type="datetime"/>
            <column name="lastmodified" type="datetime"/>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-9">
        <createTable tableName="gmao_service">
            <column autoIncrement="true" name="id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="healthcenter_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="uuid" type="VARCHAR(38)">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="code" type="VARCHAR(250)">
                <constraints nullable="false"/>
            </column>
            <column name="lastmodified" type="datetime"/>
            <column name="creation" type="datetime"/>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-10">
        <createTable tableName="gmao_site">
            <column autoIncrement="true" name="id" type="INT">
                <constraints primaryKey="true"/>
            </column>
            <column name="service_id" type="INT">
                <constraints nullable="false"/>
            </column>
            <column name="name" type="VARCHAR(32)"/>
            <column name="code" type="VARCHAR(32)"/>
            <column name="uuid" type="VARCHAR(38)">
                <constraints nullable="false"/>
            </column>
            <column name="lastmodified" type="datetime"/>
            <column name="creation" type="datetime"/>
        </createTable>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-11">
        <createIndex indexName="fk_gmao_equipment_gmao_equipment_type" tableName="gmao_equipment">
            <column name="equipment_type_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-12">
        <createIndex indexName="fk_gmao_equipment_gmao_site" tableName="gmao_equipment">
            <column name="site_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-13">
        <createIndex indexName="fk_gmao_healthcenter_gmao_district" tableName="gmao_healthcenter">
            <column name="distrct_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-14">
        <createIndex indexName="fk_gmao_maintenance_gmao_equipment" tableName="gmao_maintenance">
            <column name="equipment_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-15">
        <createIndex indexName="fk_gmao_maintenance_gmao_maintenance_request" tableName="gmao_maintenance">
            <column name="maintenance_requested_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-16">
        <createIndex indexName="fk_gmao_maintenance_gmao_maintenance_type" tableName="gmao_maintenance">
            <column name="maintenance_type_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-17">
        <createIndex indexName="fk_gmao_maintenance_request_gmao_equipment" tableName="gmao_maintenance_request">
            <column name="equipment_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-18">
        <createIndex indexName="fk_gmao_mouvement_gmao_equipment" tableName="gmao_mouvement">
            <column name="equipment_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-19">
        <createIndex indexName="fk_gmao_mouvement_gmao_site" tableName="gmao_mouvement">
            <column name="destination_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-20">
        <createIndex indexName="fk_gmao_mouvement_gmao_site1" tableName="gmao_mouvement">
            <column name="source_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-21">
        <createIndex indexName="fk_gmao_service_gmao_healthcenter" tableName="gmao_service">
            <column name="healthcenter_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-22">
        <createIndex indexName="fk_gmao_site_gmao_service" tableName="gmao_site">
            <column name="service_id"/>
        </createIndex>
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-23">
        <addForeignKeyConstraint baseColumnNames="equipment_type_id" baseTableName="gmao_equipment" constraintName="fk_gmao_equipment_gmao_equipment_type" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="gmao_equipment_type" />
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-24">
        <addForeignKeyConstraint baseColumnNames="site_id" baseTableName="gmao_equipment" constraintName="fk_gmao_equipment_gmao_site" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="gmao_site" />
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-25">
        <addForeignKeyConstraint baseColumnNames="distrct_id" baseTableName="gmao_healthcenter" constraintName="fk_gmao_healthcenter_gmao_district" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="gmao_district" />
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-26">
        <addForeignKeyConstraint baseColumnNames="equipment_id" baseTableName="gmao_maintenance" constraintName="fk_gmao_maintenance_gmao_equipment" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="gmao_equipment" />
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-27">
        <addForeignKeyConstraint baseColumnNames="maintenance_requested_id" baseTableName="gmao_maintenance" constraintName="fk_gmao_maintenance_gmao_maintenance_request" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="gmao_maintenance_request" />
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-28">
        <addForeignKeyConstraint baseColumnNames="maintenance_type_id" baseTableName="gmao_maintenance" constraintName="fk_gmao_maintenance_gmao_maintenance_type" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="gmao_maintenance_type" />
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-29">
        <addForeignKeyConstraint baseColumnNames="equipment_id" baseTableName="gmao_maintenance_request" constraintName="fk_gmao_maintenance_request_gmao_equipment" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="gmao_equipment" />
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-30">
        <addForeignKeyConstraint baseColumnNames="equipment_id" baseTableName="gmao_mouvement" constraintName="fk_gmao_mouvement_gmao_equipment" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="gmao_equipment" />
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-31">
        <addForeignKeyConstraint baseColumnNames="destination_id" baseTableName="gmao_mouvement" constraintName="fk_gmao_mouvement_gmao_site" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="gmao_site" />
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-32">
        <addForeignKeyConstraint baseColumnNames="source_id" baseTableName="gmao_mouvement" constraintName="fk_gmao_mouvement_gmao_site1" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="gmao_site" />
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-33">
        <addForeignKeyConstraint baseColumnNames="healthcenter_id" baseTableName="gmao_service" constraintName="fk_gmao_service_gmao_healthcenter" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="gmao_healthcenter" />
    </changeSet>
    <changeSet author="anatoleabe (generated)" id="1639051760881-34">
        <addForeignKeyConstraint baseColumnNames="service_id" baseTableName="gmao_site" constraintName="fk_gmao_site_gmao_service" deferrable="false" initiallyDeferred="false" onDelete="NO ACTION" onUpdate="NO ACTION" referencedColumnNames="id" referencedTableName="gmao_service" />
    </changeSet>
    <changeSet author="enokby" id="enokby-20211219-1">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">select count(*) from gmao_maintenance_type;</sqlCheck>
        </preConditions>
        <insert tableName="gmao_maintenance_type">
            <column name="name" value="Préventive"/>
            <column name="id" value="1"/>
            <column name="uuid" value="b0000001-d22b-493e-98e8-4d1de0621a8v"/>
        </insert>
        <insert tableName="gmao_maintenance_type">
            <column name="name" value="Curative"/>
            <column name="id" value="2"/>
            <column name="uuid" value="b0000002-d22b-493e-98e8-4d1de0621a8v"/>
        </insert>
    </changeSet>
    
    <changeSet author="anatoleabe" id="1639051760881-35"> 
        <addColumn tableName="gmao_maintenance" >
            <column name="reason" type="VARCHAR(255)"/>
        </addColumn>  
    </changeSet>
    
    <changeSet author="anatoleabe" id="1639051760881-36"> 
        <addColumn tableName="gmao_mouvement" >
            <column name="status" type="VARCHAR(10)"/>
        </addColumn>  
    </changeSet>
    
</databaseChangeLog>
